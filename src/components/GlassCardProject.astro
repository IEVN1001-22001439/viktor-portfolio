---
import "../styles/global.css";

export interface Props {
    title: string;
    description: string;
    imageUrl: string;
    tags?: string[];
    imageGradient?: string;
    cardClass?: string;
    imageClass?: string;
    imagePosition?: "left" | "center" | "right";
    imageRotation?: "none" | "slight-left" | "slight-right" | "moderate";
    imageScale?: "normal" | "small" | "medium";
    projectUrl?: string;
}

const {
    title = "Project Title",
    description = "Project description",
    imageUrl = "/images/default-project.webp",
    tags = [],
    imageGradient = "from-light-yellow to-light-green",
    cardClass = "",
    imageClass = "",
    imagePosition = "center",
    imageRotation = "none",
    imageScale = "normal",
    projectUrl,
} = Astro.props;

const positionClasses = {
    left: "justify-start",
    center: "justify-center",
    right: "justify-end",
};

const rotationClasses = {
    none: "rotate-0",
    "slight-left": "-rotate-2",
    "slight-right": "rotate-2",
    moderate: "rotate-3",
};

const scaleClasses = {
    normal: "w-full h-full",
    small: "w-4/5 h-4/5",
    medium: "w-11/12 h-11/12",
};
---

<article
    class={`w-full h-[500px] sm:h-[250px] lg:h-[500px]
        bg-white/10 backdrop-blur-md border-white border-1 inset-shadow-sm shadow-md
        rounded-2xl p-6
        hover:scale-[1.02] transition-all duration-500 hover:bg-white/20 hover:shadow-sm hover:inset-shadow-md
        flex flex-col ${cardClass}`}
>
    <div class="h-48 flex-shrink-0">
        <div
            class={`w-full h-full bg-gradient-to-tl ${imageGradient} rounded-2xl overflow-hidden relative perspective-1000`}
        >
            <div
                class={`w-full h-full flex ${positionClasses[imagePosition]} items-center transition-all duration-700 ease-out`}
            >
                <div
                    class={`relative ${scaleClasses[imageScale]} ${rotationClasses[imageRotation]}
                        hover:rotate-0 hover:scale-105 transition-all duration-500 shadow-lg`}
                >
                    <img
                        class="w-full h-full object-cover rounded-xl"
                        src={imageUrl}
                        alt={title}
                        loading="lazy"
                    />
                </div>
            </div>
        </div>
    </div>

    <div class="flex-1 flex flex-col justify-between pt-4 min-h-0">
        <div class="flex-1 overflow-hidden">
            <div class="mb-3">
                <div class="flex items-center gap-2">
                    <h4 class="text-black/70 font-semibold text-lg md:text-xl line-clamp-2">
                        {title}
                    </h4>

                    {
                        projectUrl && (
                            <a
                                href={projectUrl}
                                target="_blank"
                                rel="noopener noreferrer"
                                class="inline-flex items-center justify-center text-black/60 hover:text-black transition-colors duration-300 group"
                                aria-label={`Visit ${title}`}
                            >

                                <svg
                                    xmlns="http://www.w3.org/2000/svg"
                                    viewBox="0 0 24 24"
                                    fill="none"
                                    stroke="currentColor"
                                    stroke-width="2"
                                    stroke-linecap="round"
                                    stroke-linejoin="round"
                                    class="w-7 h-7 transform group-hover:-translate-y-[2px] group-hover:translate-x-[2px] transition-transform duration-300"
                                >
                                    <path d="M7 17L17 7M7 7h10v10" />
                                </svg>
                            </a>
                        )
                    }
                </div>

                <h5 class="text-black/50 font-light text-sm md:text-base leading-relaxed line-clamp-6 mt-1">
                    {description}
                </h5>
            </div>
        </div>

        {
            tags.length > 0 && (
                <div class="flex flex-wrap gap-2 mt-3 pt-3 border-t border-white/20">
                    {tags.map((tag) => (
                        <span
                            class="bg-white/20 border border-white/40 rounded-full py-1.5 px-3 text-black/70 font-medium text-xs
                                hover:bg-white/40 hover:shadow-md hover:shadow-black/10 transition-all duration-300 line-clamp-1"
                        >
                            {tag}
                        </span>
                    ))}
                </div>
            )
        }
    </div>

    <slot />
</article>

<style is:global>
.perspective-1000 {
    perspective: 1000px;
}

* {
    transform-style: preserve-3d;
}

.line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.line-clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.line-clamp-1 {
    display: -webkit-box;
    -webkit-line-clamp: 1;
    -webkit-box-orient: vertical;
    overflow: hidden;
}
</style>
